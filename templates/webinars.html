<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webinars & Podcasts - Inspektra</title>
    <meta name="description" content="Listen to the latest insights on electrical safety and compliance.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <style>
        /* Specific overrides for the media player page to make it full height */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #FFFFFF;
            color: #0F172A;
        }
        
        .media-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            flex-grow: 1;
            height: calc(100vh - 85px - 90px); /* Viewport - Nav - Player */
            overflow: hidden;
        }

        .media-sidebar {
            background-color: #F8FAFC;
            border-right: 1px solid #E2E8F0;
            overflow-y: auto;
            padding: 24px;
        }

        .media-main {
            background: white;
            overflow-y: auto;
            padding: 40px;
        }

        .episode-list-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-bottom: 8px;
            color: #64748B;
        }

        .episode-list-item:hover {
            background-color: #E2E8F0;
            color: #0F172A;
        }

        .episode-list-item.active {
            background-color: #E0F2FE;
            color: #005FAD; /* Brand color */
        }

        .episode-thumb-small {
            width: 48px;
            height: 48px;
            border-radius: 4px;
            background-size: cover;
            margin-right: 12px;
            flex-shrink: 0;
            background-color: #CBD5E1;
        }

        .episode-info-small h4 {
            font-size: 0.95rem;
            margin-bottom: 4px;
            color: inherit;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 600;
        }

        .episode-info-small p {
            font-size: 0.8rem;
            margin: 0;
            color: #94A3B8;
        }        /* Main Content Area */
        .media-header {
            display: flex;
            align-items: flex-end;
            gap: 24px;
            margin-bottom: 32px;
        }

        .media-cover-large {
            width: 232px;
            height: 232px;
            box-shadow: 0 4px 60px rgba(0,0,0,0.5);
            background-size: cover;
            background-position: center;
        }

        .media-details h5 {
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 8px;
            color: #64748B;
            font-weight: 600;
        }

        .media-details h1 {
            font-size: 3rem; /* Large title */
            margin-bottom: 16px;
            color: #0F172A;
            background: none;
            -webkit-text-fill-color: initial;
            font-weight: 800;
            letter-spacing: -0.02em;
        }

        .media-meta {
            color: #64748B;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-buttons {
            margin-top: 32px;
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .btn-play-large {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: #005FAD; /* Brand color */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
            box-shadow: 0 4px 12px rgba(0, 95, 173, 0.3);
        }

        .btn-play-large:hover {
            transform: scale(1.05);
            background-color: #004884;
        }

        .btn-play-large svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
            margin-left: 4px; /* Optical center */
        }

        /* Player Bar */
        .player-bar {
            height: 90px;
            background-color: #FFFFFF;
            border-top: 1px solid #E2E8F0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
        }

        .player-left {
            display: flex;
            align-items: center;
            width: 30%;
            min-width: 180px;
        }

        .player-cover {
            width: 56px;
            height: 56px;
            background-color: #CBD5E1;
            margin-right: 14px;
            border-radius: 4px;
            background-size: cover;
        }

        .player-info h4 {
            font-size: 0.9rem;
            margin-bottom: 4px;
            color: #0F172A;
            font-weight: 600;
        }

        .player-info p {
            font-size: 0.75rem;
            color: #64748B;
            margin: 0;
        }

        .player-center {
            width: 40%;
            max-width: 722px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 8px;
        }

        .control-btn {
            background: none;
            border: none;
            color: #94A3B8;
            cursor: pointer;
            transition: color 0.2s;
        }

        .control-btn:hover {
            color: #0F172A;
        }

        .control-btn.play-pause {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #0F172A;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn.play-pause:hover {
            transform: scale(1.05);
            color: white;
            background-color: #005FAD;
        }

        .progress-container {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            color: #64748B;
        }

        .progress-bar {
            flex-grow: 1;
            height: 4px;
            background-color: #E2E8F0;
            border-radius: 2px;
            position: relative;
            cursor: pointer;
        }

        .progress-fill {
            width: 0%;
            height: 100%;
            background-color: #0F172A;
            border-radius: 2px;
        }
        
        .progress-bar:hover .progress-fill {
            background-color: #005FAD;
        }

        .player-right {
            width: 30%;
            display: flex;
            justify-content: flex-end;
            align-items: center;
        }

        @media (max-width: 768px) {
            .media-layout {
                grid-template-columns: 1fr;
                height: auto;
                padding-bottom: 100px;
            }
            .media-sidebar {
                display: none; /* Hide sidebar on mobile for now, or make it a drawer */
            }
            .media-main {
                padding: 20px;
            }
            .media-header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .media-cover-large {
                width: 180px;
                height: 180px;
            }
            .action-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="container">
            <a href="../index.html" class="logo">
                <img src="../inspektra-logo.png" alt="Inspektra" height="40">
            </a>
            <ul class="nav-links">
                <li><a href="../why-inspektra.html">Why Inspektra</a></li>
                <li><a href="../features.html">Features</a></li>
                <li><a href="../pricing.html">Pricing</a></li>
                <li class="dropdown">
                    <a href="#" class="active">Resources</a>
                    <ul class="dropdown-menu">
                        <li><a href="../blog/index.html">Blog</a></li>
                        <li><a href="../webinars/index.html" class="active">Webinars</a></li>
                        <li><a href="../academy/index.html">Academy</a></li>
                    </ul>
                </li>
                <li><a href="../contact.html">Contact</a></li>
            </ul>
            <div class="nav-cta">
                <a href="#" class="btn btn-secondary" style="color: white;">Log in</a>
                <a href="#" class="btn btn-primary">Request a demo</a>
            </div>
        </div>
    </nav>

    <div class="media-layout">
        <aside class="media-sidebar">
            <h3 style="color: white; margin-bottom: 20px; font-size: 1.2rem; padding-left: 12px;">Episodes</h3>
            <div id="episode-list">
                {{episode_list_html}}
            </div>
        </aside>

        <main class="media-main" id="main-content">
            <!-- Dynamic Content Loaded Here -->
            <div class="media-header">
                <div class="media-cover-large" style="background-image: url('{{latest_image}}');" id="main-image"></div>
                <div class="media-details">
                    <h5 id="main-type">{{latest_type}}</h5>
                    <h1 id="main-title">{{latest_title}}</h1>
                    <div class="media-meta">
                        <span id="main-guest">With {{latest_guest}}</span> • <span id="main-date">{{latest_date}}</span> • <span id="main-duration">{{latest_duration}}</span>
                    </div>
                    <div class="action-buttons">
                        <button class="btn-play-large" onclick="playEpisode('{{latest_audio}}', '{{latest_title}}', '{{latest_guest}}', '{{latest_image}}')">
                            <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                        </button>
                        <button class="btn btn-outline" style="border-color: rgba(255,255,255,0.3); color: white;">Share</button>
                    </div>
                </div>
            </div>

            <div class="blog-content" style="color: #b3b3b3; max-width: 800px;">
                <h3 style="color: white;">About this Episode</h3>
                <div id="main-description">
                    {{latest_body}}
                </div>
            </div>
        </main>
    </div>

    <div class="player-bar">
        <div class="player-left">
            <div class="player-cover" id="player-cover" style="background-image: url('{{latest_image}}');"></div>
            <div class="player-info">
                <h4 id="player-title">{{latest_title}}</h4>
                <p id="player-artist">{{latest_guest}}</p>
            </div>
        </div>
        <div class="player-center">
            <div class="player-controls">
                <button class="control-btn"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M13 2.5L5 7.119V3H3v10h2V8.881l8 4.619V2.5z"/></svg></button>
                <button class="control-btn play-pause" id="play-pause-btn" onclick="togglePlay()">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" id="play-icon"><path d="M3 2l10 6-10 6z"/></svg>
                </button>
                <button class="control-btn"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M3 2.5l8 4.619V3h2v10h-2V8.881l-8 4.619V2.5z"/></svg></button>
            </div>
            <div class="progress-container">
                <span id="current-time">0:00</span>
                <div class="progress-bar" id="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <span id="total-time">{{latest_duration}}</span>
            </div>
        </div>
        <div class="player-right">
            <!-- Volume etc -->
        </div>
    </div>

    <audio id="audio-player" src="{{latest_audio}}"></audio>

    <script>
        const audioPlayer = document.getElementById('audio-player');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M3 2l10 6-10 6z"/></svg>';
        const pauseIcon = '<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M3 2h4v12H3zm6 0h4v12H9z"/></svg>';
        const progressBar = document.getElementById('progress-bar');
        const progressFill = document.getElementById('progress-fill');
        const currentTimeEl = document.getElementById('current-time');
        const totalTimeEl = document.getElementById('total-time');

        // Episode Data (Injected by build script)
        const episodes = {{episodes_json}};

        function togglePlay() {
            if (audioPlayer.paused) {
                audioPlayer.play();
                playPauseBtn.innerHTML = pauseIcon;
            } else {
                audioPlayer.pause();
                playPauseBtn.innerHTML = playIcon;
            }
        }

        function playEpisode(url, title, guest, image) {
            // Update Player Bar
            document.getElementById('player-title').innerText = title;
            document.getElementById('player-artist').innerText = guest;
            document.getElementById('player-cover').style.backgroundImage = `url('${image}')`;
            
            audioPlayer.src = url;
            audioPlayer.play();
            playPauseBtn.innerHTML = pauseIcon;
        }

        function loadEpisodeDetails(index) {
            const ep = episodes[index];
            
            // Update Main View
            document.getElementById('main-image').style.backgroundImage = `url('${ep.image}')`;
            document.getElementById('main-type').innerText = ep.type;
            document.getElementById('main-title').innerText = ep.title;
            document.getElementById('main-guest').innerText = `With ${ep.guest}`;
            document.getElementById('main-date').innerText = new Date(ep.date).toLocaleDateString();
            document.getElementById('main-duration').innerText = ep.duration;
            document.getElementById('main-description').innerHTML = ep.body;
            
            // Update Play Button in Main View
            const playBtn = document.querySelector('.btn-play-large');
            playBtn.onclick = () => playEpisode(ep.audio_url, ep.title, ep.guest, ep.image);

            // Highlight active in list
            document.querySelectorAll('.episode-list-item').forEach((el, i) => {
                if (i === index) el.classList.add('active');
                else el.classList.remove('active');
            });
        }

        audioPlayer.addEventListener('timeupdate', () => {
            const percent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progressFill.style.width = `${percent}%`;
            
            // Update time text
            const currentMinutes = Math.floor(audioPlayer.currentTime / 60);
            const currentSeconds = Math.floor(audioPlayer.currentTime % 60);
            currentTimeEl.innerText = `${currentMinutes}:${currentSeconds < 10 ? '0' : ''}${currentSeconds}`;
        });

        audioPlayer.addEventListener('loadedmetadata', () => {
             const totalMinutes = Math.floor(audioPlayer.duration / 60);
             const totalSeconds = Math.floor(audioPlayer.duration % 60);
             totalTimeEl.innerText = `${totalMinutes}:${totalSeconds < 10 ? '0' : ''}${totalSeconds}`;
        });

        progressBar.addEventListener('click', (e) => {
            const width = progressBar.clientWidth;
            const clickX = e.offsetX;
            const duration = audioPlayer.duration;
            audioPlayer.currentTime = (clickX / width) * duration;
        });

    </script>
</body>
</html>